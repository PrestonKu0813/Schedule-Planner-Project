@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  /* day row */
  --dayRowHeight: 8%;
  /* hour column */
  --hourWidth: 12%;
  --minHourWidth: 12%;
  /* calendar key color */
  --calendar-key-color-width: 18%;
}

@layer components {
  /* Outer container to hold everything */

  .calendar_container {
    @apply relative w-full h-full border-4 border-black bg-[#e7e2d5];
    @apply flex flex-col overflow-hidden;
  }

  /* HEADER ROW */
  .calendar_header_row {
    @apply flex flex-row h-[var(--dayRowHeight)] border-b-2  border-y-blue-950;
  }

  /* Empty cell for time column header */
  .time_header_cell {
    @apply w-[var(--hourWidth)] min-w-[var(--minHourWidth)] border-r-4 border-red-400;
  }

  /* Each day cell in the header */
  .day_header_cell {
    @apply flex-1 flex items-center justify-center;
    font-size: clamp(0.4rem, 2vw, 1rem);
    font-weight: 400;
  }

  /* MAIN BODY (the actual schedule area) */
  .calendar_body {
    @apply relative w-full h-full flex flex-col;
    /* This is where hour lines, time labels, and classes are absolutely positioned */
    @apply overflow-hidden;
  }

  /* Hour lines */
  .hour_line {
    @apply flex-1 border-b border-y-blue-950;
    /* 'top' is set inline via style={{ top: '...%' }} */
  }

  /* Time label that appears on each hour line (left side, 10% wide) */

  .time_label {
    @apply border-r-4 border-red-400 w-[var(--hourWidth)] h-full text-center font-bold text-xs text-opacity-0;
    /* Slight vertical centering so the label hovers around the line */
  }

  /* Each scheduled class */
  .calendar_class {
    @apply absolute text-center
    bg-gray-400 bg-opacity-70 
    border-2 border-gray-950;
    font-size: clamp(0.55rem, 0.8vw, 0.7rem);
    padding: 2px;
    overflow-x: hidden;
    overflow-y: hidden;
    text-overflow: ellipsis;
    line-height: 1;
  }

  /* Preview class for hover effects */
  .preview-class {
    @apply absolute text-center;
    font-size: clamp(0.55rem, 0.8vw, 0.7rem);
    padding: 2px;
    overflow-x: hidden;
    overflow-y: hidden;
    text-overflow: ellipsis;
    line-height: 1;
    pointer-events: none;
    transition: all 0.2s ease;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
  }

  /* Handle very short class blocks */
  .calendar_class.short-block,
  .preview-class.short-block {
    font-size: clamp(0.5rem, 0.8vw, 0.6rem);
    padding: 1px;
    min-height: 15px;
  }

  /* Handle medium height blocks */
  .calendar_class.medium-block,
  .preview-class.medium-block {
    font-size: clamp(0.55rem, 0.9vw, 0.7rem);
    padding: 2px;
    min-height: 18px;
  }

  /* Enhanced text visibility without overriding campus colors */
  .calendar_class,
  .preview-class {
    /* Keep campus colors but ensure text is readable */
    font-weight: bold;
  }

  /* Add a subtle border to make text stand out more */
  .calendar_class::after,
  .preview-class::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
    pointer-events: none;
    z-index: -1;
  }

  /* Enhanced conflict styles */
  .preview-class.conflict {
    border-width: 4px !important;
    border-style: solid !important;
    border-color: #ff0000 !important; /* Bright red */
    box-shadow: 0 0 15px rgba(255, 0, 0, 0.6), inset 0 0 10px rgba(255, 0, 0, 0.2); /* Red glow */
    animation: conflictPulse 1.5s ease-in-out infinite; /* Pulsing animation */
    background: linear-gradient(45deg, rgba(255, 0, 0, 0.1), rgba(255, 0, 0, 0.2)) !important; /* Red gradient background */
  }

  .preview-class.no-conflict {
    border-width: 4px !important;
    border-style: solid !important;
    border-color: #00ff00 !important; /* Bright green */
    box-shadow: 0 0 15px rgba(0, 255, 0, 0.6), inset 0 0 10px rgba(0, 255, 0, 0.2); /* Green glow */
    animation: successPulse 2s ease-in-out infinite; /* Gentle pulse */
    background: linear-gradient(45deg, rgba(0, 255, 0, 0.1), rgba(0, 255, 0, 0.2)) !important; /* Green gradient background */
  }

  /* Pulsing animation for conflicts */
  @keyframes conflictPulse {
    0%, 100% {
      transform: scale(1);
      box-shadow: 0 0 15px rgba(255, 0, 0, 0.6), inset 0 0 10px rgba(255, 0, 0, 0.2);
    }
    50% {
      transform: scale(1.02);
      box-shadow: 0 0 20px rgba(255, 0, 0, 0.8), inset 0 0 15px rgba(255, 0, 0, 0.3);
    }
  }

  /* Gentle pulse for no conflicts */
  @keyframes successPulse {
    0%, 100% {
      transform: scale(1);
      box-shadow: 0 0 15px rgba(0, 255, 0, 0.6), inset 0 0 10px rgba(0, 255, 0, 0.2);
    }
    50% {
      transform: scale(1.01);
      box-shadow: 0 0 18px rgba(0, 255, 0, 0.7), inset 0 0 12px rgba(0, 255, 0, 0.25);
    }
  }

  /* Additional visual indicators */
  .preview-class::before {
    content: '';
    position: absolute;
    top: -2px;
    left: -2px;
    right: -2px;
    bottom: -2px;
    border-radius: inherit;
    z-index: -1;
    opacity: 0.3;
  }

  .preview-class.conflict::before {
    background: radial-gradient(circle, rgba(255, 0, 0, 0.3) 0%, transparent 70%);
  }

  .preview-class.no-conflict::before {
    background: radial-gradient(circle, rgba(0, 255, 0, 0.3) 0%, transparent 70%);
  }

  .popup {
    @apply absolute bg-white border border-black p-2 z-10 shadow-md max-w-[200px];
    /* not sure if you should use px for max width */
  }

  .popup-close {
    @apply absolute top-[5px] right-[5px] bg-none border-none text-[1rem] cursor-pointer;
  }

  /* CALENDAR KEY CSS SECTION */
  .calendar_key_container {
    @apply w-full h-full;
    @apply flex flex-col gap-[5px];
  }

  .calendar_key_rows {
    @apply flex flex-row h-full gap-[5px];
  }

  .calendar_key_cols {
    @apply flex w-full flex-row border-4 border-black;
  }

  .calendar_key {
    @apply flex w-[var(--calendar-key-color-width)];
  }

  #text {
    @apply font-semibold;
    font-size: clamp(0.6rem, 1.5vw, 1rem);
    align-self: center;
    margin-left: 2%;
    overflow-x: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }

  #busch {
    @apply bg-blue-300;
  }

  #livi {
    @apply bg-orange-300;
  }

  #CA {
    @apply bg-yellow-200;
  }

  #CD {
    @apply bg-green-300;
  }

  #downtown {
    @apply bg-pink-300;
  }

  #online {
    @apply bg-red-400;
  }
}
